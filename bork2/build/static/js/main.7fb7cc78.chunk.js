(this.webpackJsonpbork2=this.webpackJsonpbork2||[]).push([[0],{50:function(e,t,n){e.exports=n.p+"static/media/pig_logo.d0d99a55.png"},60:function(e,t,n){e.exports=n(85)},77:function(e,t,n){},78:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t),n.d(t,"renderLogin",(function(){return N})),n.d(t,"renderPageWithUserID",(function(){return W})),n.d(t,"renderChat",(function(){return H}));var a=n(17),s=n.n(a),o=n(24),r=n(0),i=n.n(r),c=n(8),l=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(66);u.initializeApp({apiKey:"AIzaSyBriNz3DFDo1ra0CmHC0_ZpoCYnonSWOoo",authDomain:"bork-cc.firebaseapp.com",projectId:"bork-cc",databaseURL:"https://bork-cc.firebaseio.com"});var d=u.auth(),b=u.firestore(),m=u.database(),h=u.functions(),p=(n(77),n(15)),y=n(16),f=n(21),v=n(20),g=n(119),E=n(115),j=n(120);n(78);function L(){k(document.getElementById("solo-queue-button"),"soloQueue"),function(){var e=document.getElementById("join-lobby-button"),t=document.getElementById("join-input-button");k(e,"joinLobby"),k(t,"joinLobby")}(),function(){var e=document.getElementById("create-lobby-button"),t=document.getElementById("create-input-button");k(e,"createLobby"),k(t,"createLobby")}()}function k(e,t){e.addEventListener("click",function(e,t){var n=0;return function(){var a=new Date;a-n>=t?(e(),n=a):console.log("waiting")}}(function(){var e=Object(o.a)(s.a.mark((function e(n){var a,o,r,i,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.getElementById("username-textfield"),o=a.value,r=O(t),i=h.httpsCallable("signIn"),e.next=6,i({username:o,chatID:r,signInType:t});case 6:c=e.sent,l=c.data,console.log(l),l.usernameError||l.createLobbyError||l.joinLobbyError?N(l.usernameError,l.usernameErrorMessage,l.createLobbyError,l.createLobbyErrorMessage,l.joinLobbyError,l.joinLobbyErrorMessage):H(l.chatID,l.username);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),2e3))}function O(e){var t=document.getElementById("join-lobby-input"),n=document.getElementById("create-lobby-input");return"joinLobby"===e?t.value:"createLobby"===e?n.value:null}var I=n(50),S=n.n(I),C=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(p.a)(this,n),t.call(this,e)}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"full-frame"},this.loginFrame())}},{key:"loginFrame",value:function(){return i.a.createElement("div",{class:"login-frame"},i.a.createElement(x,this.props),i.a.createElement(D,null))}}]),n}(r.Component),x=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(p.a)(this,n),t.call(this,e)}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"form-frame"},this.description(),i.a.createElement(B,this.props))}},{key:"description",value:function(){return i.a.createElement("div",{class:"descriptions"},i.a.createElement("h2",{class:"main-description"},"Enter Among Us Lobbies!"),i.a.createElement("h3",{class:"sub-description"},i.a.createElement("p",{id:"username-warning"})))}}]),n}(r.Component),B=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).styles={soloStyle:{fontSize:20,background:"linear-gradient(45deg, #2196F3 5%, #21CBF3 90%)",color:"white"},createStyle:{height:"100%",width:"100%",borderWidth:1.2,borderColor:"#21CBF3",fontSize:20,color:"#21CBF3"},joinStyle:{height:"100%",width:"100%",borderWidth:1.2,borderColor:"#21CBF3",fontSize:20,color:"#21CBF3"},textFieldStyle:{borderTopRightRadius:"0px",borderBottomRightRadius:"0px",borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},buttonStyle:{height:"100%",width:"30%",borderTopRightRadius:"20px",borderBottomRightRadius:"20px",borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px",background:"#21CBF3",color:"white"}},a}return Object(y.a)(n,[{key:"render",value:function(){return this.formGrid()}},{key:"formGrid",value:function(){return i.a.createElement(E.a,{container:!0,class:"container"},i.a.createElement(g.a,{class:"username-textfield",id:"username-textfield",variant:"outlined",error:this.props.usernameError,label:"Username",helperText:this.props.usernameHelperText,fullWidth:!0,autoComplete:"off",InputLabelProps:{style:{fontSize:25}},InputProps:{style:{height:65,fontSize:25}},inputProps:{style:{fontSize:40,textAlign:"center"}}}),i.a.createElement(j.a,{className:"solo-queue-button",id:"solo-queue-button",variant:"contained",color:"primary",size:"large",fullWidth:!0,style:this.styles.soloStyle},"Solo Queue"),i.a.createElement(E.a,{item:!0,class:"buttons"},this.createLobbyButtonSet(),this.joinLobbyButtonSet()))}},{key:"createLobbyButtonSet",value:function(){return i.a.createElement("div",{id:"create-lobby-box",onMouseEnter:this.displayChange("create-invis","create-show"),onMouseLeave:this.displayChange("create-show","create-invis")},i.a.createElement(j.a,{id:"create-lobby-button",variant:"outlined",color:"primary",size:"large",fullWidth:!0,style:this.styles.createStyle},"Create Lobby"),this.createLobbyDropdown())}},{key:"joinLobbyButtonSet",value:function(){return i.a.createElement("div",{id:"join-lobby-box",onMouseEnter:this.displayChange("join-invis","join-show"),onMouseLeave:this.displayChange("join-show","join-invis")},i.a.createElement(j.a,{id:"join-lobby-button",variant:"outlined",color:"primary",size:"large",fullWidth:!0,style:this.styles.joinStyle},"Join Lobby"),this.joinLobbyDropdown())}},{key:"createLobbyDropdown",value:function(){return i.a.createElement("div",{class:"create-lobby-div",id:"create-invis"},i.a.createElement(g.a,{className:"create-lobby-input",hidden:!0,id:"create-lobby-input",variant:"outlined",type:"text",autoComplete:"off",label:"Enter Lobby ID",error:this.props.createLobbyError,helperText:this.props.createLobbyHelperText,InputProps:{style:this.styles.textFieldStyle}}),i.a.createElement(j.a,{id:"create-input-button",variant:"contained",color:"primary",style:this.styles.buttonStyle},i.a.createElement("p",{class:"create-input-text"},"Join!")))}},{key:"joinLobbyDropdown",value:function(){return i.a.createElement("div",{class:"join-lobby-div",id:"join-invis"},i.a.createElement(g.a,{className:"join-lobby-input",hidden:!0,id:"join-lobby-input",variant:"outlined",type:"text",autoComplete:"off",label:"Enter Lobby ID",error:this.props.joinLobbyError,helperText:this.props.joinLobbyHelperText,InputProps:{style:this.styles.textFieldStyle}}),i.a.createElement(j.a,{id:"join-input-button",variant:"contained",color:"primary",style:this.styles.buttonStyle},i.a.createElement("p",{class:"join-input-text"},"Join!")))}},{key:"displayChange",value:function(e,t){return function(){document.getElementById(e).setAttribute("id",t)}}}]),n}(r.Component),D=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"hog-pub-frame"},this.hogPubHeader(),this.comingSoon(),this.logo())}},{key:"hogPubHeader",value:function(){return i.a.createElement("h1",{class:"header"},"Hog Pub")}},{key:"comingSoon",value:function(){return i.a.createElement("h3",{class:"coming-soon"},"Other games coming soon!")}},{key:"logo",value:function(){return i.a.createElement("img",{class:"logo",src:S.a,alt:"logo"})}}]),n}(r.Component);var M=n(41),w=n(45),F=n(12),P=n(52),A=(n(84),function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={chatID:a.props.chatID,userID:d.currentUser.uid,username:a.props.username,lobbyOpen:null,participants:{},numParticipants:0},a.setLobbyOpen(),a.handleLogout=a.handleLogout.bind(Object(F.a)(a)),a.getParticipants=a.getParticipants.bind(Object(F.a)(a)),a.handleLobbyStatusChange=a.handleLobbyStatusChange.bind(Object(F.a)(a)),a.changeConnectionStatus=a.changeConnectionStatus.bind(Object(F.a)(a)),a.addAllListeners=a.addAllListeners.bind(Object(F.a)(a)),a.addAllListeners(),console.log(a.props.username),a}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"full-frame"},i.a.createElement(T,{chatID:this.state.chatID,lobbyOpen:this.state.lobbyOpen,handleLogout:this.handleLogout,handleLobbyStatusChange:this.handleLobbyStatusChange}),i.a.createElement(R,{chatID:this.state.chatID,userID:this.state.userID,username:this.props.username,initTime:new Date}),i.a.createElement(z,{ref:"videoFrame",videoCallURL:"https://hogpub.daily.co/".concat(this.state.chatID)}))}},{key:"addAllListeners",value:function(){this.getParticipants(),this.changeConnectionStatus()}},{key:"getParticipants",value:function(){var e=this;b.collection("chats").doc(this.state.chatID).collection("participants").orderBy("timestamp").onSnapshot((function(t){var n={},a=0;t.forEach((function(e){var t=e.data();n[t.user_id]=t.username,a+=1})),e.setState({numParticipants:a,participants:n})}))}},{key:"setLobbyOpen",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.collection("chats").doc(this.state.chatID).get();case 2:t=e.sent,this.setState({lobbyOpen:t.data().lobby_open});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeConnectionStatus",value:function(){m.ref("users/"+this.state.userID+"/is_disconnected").set(!1),m.ref("users/"+this.state.userID+"/is_disconnected").onDisconnect().set(!0)}},{key:"handleLobbyStatusChange",value:function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.collection("chats").doc(this.state.chatID).update({lobby_open:!this.state.lobbyOpen});case 2:this.setState({lobbyOpen:!this.state.lobbyOpen});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleLogout",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.httpsCallable("deleteUserInfo"),e.next=3,t({userId:this.state.userID,chatId:this.state.chatID,username:this.state.username}).then((function(e){})).catch((function(e){console.log(e)}));case 3:this.refs.videoFrame.disconnect(),d.signOut();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(r.Component)),T=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(p.a)(this,n),t.call(this,e)}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"lobby-frame"},this.hogPub(),this.misc())}},{key:"hogPub",value:function(){return i.a.createElement("div",{class:"hog-pub-box"},i.a.createElement("h1",{class:"hog-pub-header"},"The Pub"),i.a.createElement("h2",{class:"lobby-title"},"Among Us"))}},{key:"misc",value:function(){return i.a.createElement("div",{class:"misc-box"},this.openLobbyButton(),this.lobbyInfoBox(),this.leaveLobbyButton())}},{key:"openLobbyButton",value:function(){return i.a.createElement(j.a,{class:"start-queue-button",onClick:this.props.handleLobbyStatusChange},i.a.createElement("p",{class:"start-queue-text"},this.getLobbyButtonMessage()))}},{key:"leaveLobbyButton",value:function(){return i.a.createElement(j.a,{class:"leave-lobby-button",onClick:this.props.handleLogout},i.a.createElement("p",{class:"leave-lobby-text"},"Leave Lobby"))}},{key:"lobbyInfoBox",value:function(){return i.a.createElement("div",{class:"lobby-info-box"},i.a.createElement("h3",{class:"lobby-info-header"},"Lobby Info"),i.a.createElement("div",{class:"lobby-info-text"},i.a.createElement("p",{class:"random-stuff"},"Chat ID: ",this.props.chatID)))}},{key:"getLobbyButtonMessage",value:function(){return this.props.lobbyOpen?"Close Lobby":"Open Lobby"}}]),n}(r.Component),R=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={numMessagesSent:0,numMessagesReceived:0,messages:{},lastMessageTime:Math.floor(a.props.initTime.getTime()/1e3)},a.handleSendMessage=a.handleSendMessage.bind(Object(F.a)(a)),a.sendMessage=a.sendMessage.bind(Object(F.a)(a)),a.makeMessageBubble=a.makeMessageBubble.bind(Object(F.a)(a)),a.getMessages=a.getMessages.bind(Object(F.a)(a)),a.addAllListeners=a.addAllListeners.bind(Object(F.a)(a)),a.addAllListeners(),a}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"chat-frame-no-video",id:"chat-frame"},this.messages(),this.sendMessageBox())}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("dummyScroll");null!=e&&e.scrollIntoView(!0,{behavior:"smooth"})}},{key:"addAllListeners",value:function(){this.getMessages()}},{key:"messages",value:function(){return i.a.createElement("div",{class:"messages-frame"},this.makeMessages(),i.a.createElement("div",{id:"dummyScroll"}))}},{key:"makeMessages",value:function(){var e=[];for(var t in this.state.messages)e.push(this.makeMessageBubble(t));return e}},{key:"makeMessageBubble",value:function(e){var t=this.state.messages[e];return"user_content"==t.type?function(e,t){var n=e.userID==t?"user-message":"other-message",a=function(e){var t=e.toTimeString().substr(0,5);return t.substr(0,2)<=12?t+=" am":t=t.substr(0,2)%12+t.substr(2,5)+" pm",t}(new Date(1e3*e.timestamp.seconds));return i.a.createElement("div",{class:n},i.a.createElement("div",{class:"message-bubble"},i.a.createElement("div",{class:"message-metadata"},i.a.createElement("div",{class:"message-username"},e.username),i.a.createElement("div",{class:"message-timestamp"},a)),i.a.createElement("div",{class:"message-content"},e.content)))}(t,this.props.userID):function(e,t){return i.a.createElement("div",{class:"status-msg"},e.content)}(t,this.props.userID)}},{key:"sendMessageBox",value:function(){return i.a.createElement("form",{class:"send-message-form",onSubmit:this.handleSendMessage},i.a.createElement(g.a,{className:"send-message-input",id:"message-input",variant:"outlined",label:"Enter a message",fullWidth:!0,autoComplete:"off"}))}},{key:"getMessages",value:function(){var e=this;b.collection("chats").doc(this.props.chatID).collection("messages").orderBy("timestamp","desc").limit(1).onSnapshot((function(t){t.forEach((function(t){var n=t.data();e.setState({messages:Object(w.a)(Object(w.a)({},e.state.messages),{},Object(M.a)({},e.state.numMessagesReceived+1,n)),numMessagesReceived:e.state.numMessagesReceived+1,lastMessageTime:n.timestamp.seconds})}))}))}},{key:"handleSendMessage",value:function(e){e.preventDefault();var t=document.getElementById("message-input"),n=t.value;t.value="",""!=n&&(this.setState({numMessagesSent:this.state.numMessagesSent+1}),this.sendMessage(n))}},{key:"sendMessage",value:function(e){h.httpsCallable("sendMessage")({message:e,chatID:this.props.chatID,username:this.props.username,messageNumber:this.state.numMessagesSent})}}]),n}(r.Component),z=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={callFrame:null},a.joinCall=a.joinCall.bind(Object(F.a)(a)),a.makeCallFrame=a.makeCallFrame.bind(Object(F.a)(a)),a.joinButton=a.joinButton.bind(Object(F.a)(a)),a.addDisconnectListener=a.addDisconnectListener.bind(Object(F.a)(a)),a.addListeners=a.addListeners.bind(Object(F.a)(a)),a}return Object(y.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{class:"video-frame-no-video",id:"video-frame"},this.joinButton())}},{key:"joinButton",value:function(){return i.a.createElement(j.a,{className:"join-video-button",id:"join-video-button",variant:"contained",color:"primary",style:{},onClick:this.joinCall},i.a.createElement("p",{class:"join-video-text"},"Join Voice and Video!"))}},{key:"joinCall",value:function(){this.makeCallFrame(),this.state.callFrame.join({url:this.props.videoCallURL}),this.addListeners(),this.cssYesVideo()}},{key:"makeCallFrame",value:function(){var e=P.a.createFrame({iframeStyle:{position:"fixed",left:"60%",width:"40%",height:"100%",borderWidth:0},showLeaveButton:!0,showFullscreenButton:!0});console.log(e),this.state.callFrame=e,console.log(this.state.callFrame)}},{key:"addListeners",value:function(){this.addDisconnectListener()}},{key:"addDisconnectListener",value:function(){var e=this;this.state.callFrame.on("left-meeting",(function(t){e.state.callFrame.destroy(),e.cssNoVideo()}))}},{key:"disconnect",value:function(){null!==this.state.callFrame&&this.state.callFrame.leave()}},{key:"cssYesVideo",value:function(){var e=document.getElementById("chat-frame"),t=document.getElementById("video-frame");e.setAttribute("class","chat-frame-yes-video"),t.setAttribute("class","video-frame-yes-video")}},{key:"cssNoVideo",value:function(){var e=document.getElementById("chat-frame"),t=document.getElementById("video-frame");e.setAttribute("class","chat-frame-no-video"),t.setAttribute("class","video-frame-no-video")}}]),n}(r.Component);function N(e,t,n,a,s,o){console.log("PENIS",d.currentUser),l.a.render(i.a.createElement(C,{usernameError:e,usernameHelperText:t,createLobbyError:n,createLobbyHelperText:a,joinLobbyError:s,joinLobbyHelperText:o}),document.getElementById("root")),d.setPersistence(u.auth.Auth.Persistence.SESSION).then((function(){return d.signInAnonymously()})).catch((function(e){e.code,e.message}))}function W(e){return U.apply(this,arguments)}function U(){return(U=Object(o.a)(s.a.mark((function e(t){var n,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.collection("users").doc(t),a="",o="",e.next=5,n.get().then((function(e){e.exists&&(a=e.data().chat_id,o=e.data().username)})).catch((function(e){console.error("broke here ",e)}));case 5:""!==a?H(a,o):(N(),L());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){l.a.render(i.a.createElement(A,{chatID:e,username:t}),document.getElementById("root"))}d.onAuthStateChanged((function(e){console.log("PENIS",e),e?W(e.uid):(N(),L())})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[60,1,2]]]);
//# sourceMappingURL=main.7fb7cc78.chunk.js.map