(this.webpackJsonpbork2=this.webpackJsonpbork2||[]).push([[0],{49:function(e,t,a){e.exports=a.p+"static/media/pig_logo.d0d99a55.png"},57:function(e,t,a){e.exports=a(82)},62:function(e,t,a){},63:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(8),r=a.n(o),i=(a(62),a(17)),u=a(18),c=a(20),l=a(19),m=(a(63),a(24)),d=a.n(m),h=(a(51),a(33)),b=a(65);b.initializeApp({apiKey:"AIzaSyBriNz3DFDo1ra0CmHC0_ZpoCYnonSWOoo",authDomain:"bork-cc.firebaseapp.com",projectId:"bork-cc",databaseURL:"https://bork-cc.firebaseio.com"});var p=b.auth(),g=b.firestore(),f=b.database(),v=b.functions();function y(){E(document.getElementById("solo-queue-button"),"soloQueue")}function E(e,t){e.addEventListener("click",(function(e){!function(e){var t="-1";if("joinLobby"==e){var a=document.getElementById("join-lobby-input");t=a.value}console.log("CHAT ID:",t)}(t);var a=document.getElementById("username-textfield").value;v.httpsCallable("usernameApproval")({username:a}).then((function(e){var t=e.data;!0===t?function(e,t){p.signInAnonymously(),p.onAuthStateChanged((function(t){t&&v.httpsCallable("assignForSoloQueue")({username:e}).then((function(e){console.log(e.data)}))}))}(a):document.getElementById("username-warning").innerText=t}))}))}var j=a(117),k=a(113),I=a(118),O=a(49),S=a.n(O),L=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"full-frame"},this.loginFrame())}},{key:"loginFrame",value:function(){return s.a.createElement("div",{class:"login-frame"},s.a.createElement(D,{usernameError:this.props.usernameError,usernameLabel:this.props.usernameLabel}),s.a.createElement(M,null))}}]),a}(n.Component),D=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"form-frame"},this.description(),this.form())}},{key:"description",value:function(){return s.a.createElement("div",{class:"descriptions"},s.a.createElement("h2",{class:"main-description"},"Enter Among Us Lobbies!"),s.a.createElement("h3",{class:"sub-description"},s.a.createElement("p",{id:"username-warning"})))}},{key:"form",value:function(){return s.a.createElement(k.a,{container:!0,class:"container"},s.a.createElement(j.a,{class:"username-textfield",id:"username-textfield",variant:"outlined",error:this.props.usernameError,label:this.props.usernameLabel,fullWidth:!0,autoComplete:"off",InputLabelProps:{style:{fontSize:25}},InputProps:{style:{height:65,fontSize:25}},inputProps:{style:{fontSize:40,textAlign:"center"}}}),s.a.createElement(I.a,{className:"solo-queue-button",id:"solo-queue-button",variant:"contained",color:"primary",size:"large",fullWidth:!0},"Solo Queue"),s.a.createElement(k.a,{item:!0,class:"buttons"},s.a.createElement(I.a,{id:"create-lobby-button",variant:"outlined",color:"primary",size:"large",fullWidth:!0},"Create Lobby"),s.a.createElement("div",{id:"join-lobby-box"},s.a.createElement(I.a,{id:"join-lobby-button",variant:"outlined",color:"primary",size:"large",fullWidth:!0},"Join Lobby"))))}},{key:"componentDidMount",value:function(){var e=document.getElementById("join-lobby-box");e.addEventListener("mouseover",this.joinLobbyHover),e.addEventListener("mouseleave",this.joinLobbyNoHover)}},{key:"joinLobbyHover",value:function(){var e=document.getElementById("join-lobby-box");if(e.childElementCount>1)return null;var t=document.createElement("div");t.className="join-lobby-div";var a=document.createElement("INPUT");a.setAttribute("type","text"),a.setAttribute("autocomplete","off"),a.setAttribute("placeholder","Enter Lobby ID"),a.className="join-lobby-input",a.id="join-lobby-input";var n=document.createElement("BUTTON");n.className="join-input-button",n.id="join-input-button";var s=document.createElement("p");s.className="join-input-text",s.innerHTML="Join!",n.appendChild(s),t.appendChild(a),t.appendChild(n),e.appendChild(t),E(document.getElementById("join-lobby-button"),"joinLobby")}},{key:"joinLobbyNoHover",value:function(){var e=document.getElementById("join-lobby-box");e.removeChild(e.lastChild)}}]),a}(n.Component),M=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"hog-pub-frame"},this.hogPubHeader(),this.comingSoon(),this.logo())}},{key:"hogPubHeader",value:function(){return s.a.createElement("h1",{class:"header"},"Hog Pub")}},{key:"comingSoon",value:function(){return s.a.createElement("h3",{class:"coming-soon"},"Other games coming soon!")}},{key:"logo",value:function(){return s.a.createElement("img",{class:"logo",src:S.a,alt:"logo"})}}]),a}(n.Component),C=a(39),B=a(44),x=a(14),A=(a(81),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={chatID:n.props.chatID,userID:p.currentUser.uid,username:n.props.username,queueReady:n.props.queueReady,participants:{},numParticipants:0},n.handleLogout=n.handleLogout.bind(Object(x.a)(n)),n.getParticipants=n.getParticipants.bind(Object(x.a)(n)),n.changeQueueStatus=n.changeQueueStatus.bind(Object(x.a)(n)),n.changeConnectionStatus=n.changeConnectionStatus.bind(Object(x.a)(n)),n.addAllListeners=n.addAllListeners.bind(Object(x.a)(n)),n.addAllListeners(),n}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"full-frame"},s.a.createElement(w,{queueReady:this.state.queueReady,handleLogout:this.handleLogout,handleQueueChange:this.changeQueueStatus}),s.a.createElement(R,{chatID:this.state.chatID,userID:this.state.userID,username:this.props.username,initTime:new Date}),s.a.createElement(P,null))}},{key:"addAllListeners",value:function(){this.getParticipants(),this.changeConnectionStatus()}},{key:"getParticipants",value:function(){var e=this;g.collection("chats").doc(this.state.chatID).collection("participants").orderBy("timestamp").onSnapshot((function(t){var a={},n=0;t.forEach((function(e){var t=e.data();a[t.user_id]=t.username,n+=1})),e.setState({numParticipants:n,participants:a})}))}},{key:"changeConnectionStatus",value:function(){b.database().ref("users/"+this.state.userID+"/is_disconnected").set(!1),f.ref("users/"+this.state.userID+"/is_disconnected").onDisconnect().set(!0)}},{key:"changeQueueStatus",value:function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.collection("chats").doc(this.state.chatID).update({queue_ready:!this.state.queueReady});case 2:this.setState({queueReady:!this.state.queueReady});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleLogout",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.httpsCallable("deleteUserInfo"),e.next=3,t({userId:this.state.userID,chatId:this.state.chatID,username:this.state.username}).then((function(e){})).catch((function(e){console.log(e)}));case 3:p.signOut().then((function(){})).catch((function(e){console.log("ERROR:",e)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component)),w=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"lobby-frame"},this.hogPub(),this.misc())}},{key:"hogPub",value:function(){return s.a.createElement("div",{class:"hog-pub-box"},s.a.createElement("h1",{class:"hog-pub-header"},"The Pub"),s.a.createElement("h2",{class:"lobby-title"},"Among Us"))}},{key:"misc",value:function(){return s.a.createElement("div",{class:"misc-box"},this.startQueueButton(),this.lobbyInfoBox(),this.leaveLobbyButton())}},{key:"startQueueButton",value:function(){return s.a.createElement("button",{class:"start-queue-button",onClick:this.props.handleQueueChange},s.a.createElement("p",{class:"start-queue-text"},this.getQueueButtonMessage()))}},{key:"leaveLobbyButton",value:function(){return s.a.createElement("button",{class:"leave-lobby-button",onClick:this.props.handleLogout},s.a.createElement("p",{class:"leave-lobby-text"},"Leave Lobby"))}},{key:"lobbyInfoBox",value:function(){return s.a.createElement("div",{class:"lobby-info-box"},s.a.createElement("h3",{class:"lobby-info-header"},"Lobby Info"),s.a.createElement("div",{class:"lobby-info-text"},s.a.createElement("p",{class:"random-stuff"},"Random stuff")))}},{key:"getQueueButtonMessage",value:function(){return this.props.queueReady?"Stop Queue":"Start Queue"}}]),a}(n.Component),R=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={numMessagesSent:0,numMessagesReceived:0,messages:{},lastMessageTime:Math.floor(n.props.initTime.getTime()/1e3)},n.handleSendMessage=n.handleSendMessage.bind(Object(x.a)(n)),n.sendMessage=n.sendMessage.bind(Object(x.a)(n)),n.makeMessageBubble=n.makeMessageBubble.bind(Object(x.a)(n)),n.getMessages=n.getMessages.bind(Object(x.a)(n)),n.addAllListeners=n.addAllListeners.bind(Object(x.a)(n)),n.addAllListeners(),n}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"chat-frame"},this.messages(),this.sendMessageBox())}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("dummyScroll");null!=e&&e.scrollIntoView(!0,{behavior:"smooth"})}},{key:"addAllListeners",value:function(){this.getMessages()}},{key:"messages",value:function(){return s.a.createElement("div",{class:"messages-frame"},this.makeMessages(),s.a.createElement("div",{id:"dummyScroll"}))}},{key:"makeMessages",value:function(){var e=[];for(var t in this.state.messages)e.push(this.makeMessageBubble(t));return e}},{key:"makeMessageBubble",value:function(e){var t=this.state.messages[e];return"user_content"==t.type?function(e,t){var a=e.userID==t?"user-message":"other-message",n=function(e){var t=e.toTimeString().substr(0,5);return t.substr(0,2)<=12?t+=" am":t=t.substr(0,2)%12+t.substr(2,5)+" pm",t}(new Date(1e3*e.timestamp.seconds));return s.a.createElement("div",{class:a},s.a.createElement("div",{class:"message-bubble"},s.a.createElement("div",{class:"message-metadata"},s.a.createElement("div",{class:"message-username"},e.username),s.a.createElement("div",{class:"message-timestamp"},n)),s.a.createElement("div",{class:"mesage-content"},e.content)))}(t,this.props.userID):function(e,t){return s.a.createElement("div",{class:"status-msg"},e.content)}(t,this.props.userID)}},{key:"sendMessageBox",value:function(){return s.a.createElement("form",{class:"send-message-form",onSubmit:this.handleSendMessage},s.a.createElement("input",{class:"send-message-input",id:"message-input",placeholder:"Type a message...",autoComplete:"off"}))}},{key:"getMessages",value:function(){var e=this;g.collection("chats").doc(this.props.chatID).collection("messages").orderBy("timestamp","desc").limit(1).onSnapshot((function(t){t.forEach((function(t){var a=t.data();e.setState({messages:Object(B.a)(Object(B.a)({},e.state.messages),{},Object(C.a)({},e.state.numMessagesReceived+1,a)),numMessagesReceived:e.state.numMessagesReceived+1,lastMessageTime:a.timestamp.seconds})}))}))}},{key:"handleSendMessage",value:function(e){e.preventDefault();var t=document.getElementById("message-input"),a=t.value;t.value="",""!=a&&(this.setState({numMessagesSent:this.state.numMessagesSent+1}),this.sendMessage(a))}},{key:"sendMessage",value:function(e){g.collection("chats/").doc(this.props.chatID).collection("messages/").add({content:e,timestamp:new Date,userID:this.props.userID,username:this.props.username,messageNumber:this.state.numMessagesSent,type:"user_content"}),g.collection("chats").doc(this.props.chatID).update({last_message_time:new Date})}}]),a}(n.Component),P=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{class:"video-frame"})}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));p.onAuthStateChanged((function(e){console.log("auth changed"),e?(console.log("firebase user hehe",e),g.collection("users").doc(p.currentUser.uid).onSnapshot((function(e){var t=e.data();if(console.log(t),null!=t){console.log(t);var a=t.chat_id,n=t.username;r.a.render(s.a.createElement(A,{chatID:a,username:n,queueReady:!0,joinTime:new Date}),document.getElementById("root"))}}))):(r.a.render(s.a.createElement(L,{usernameLabel:"Username"}),document.getElementById("root")),y())})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.bd819c6d.chunk.js.map